<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Admin - License Manager</title>
</head>

<body>
<h2>Admin Panel</h2>
<p>Connected as ADMIN (token required)</p>

<h3>Statistics</h3>
<ul>
    <li>Total licenses: {{ stats.total }}</li>
    <li>Valid licenses: {{ stats.valid }}</li>
    <li>Revoked licenses: {{ stats.revoked }}</li>
    <li>Total activations: {{ stats.activations }}</li>
</ul>

<hr>

<h3>Create license</h3>
<form method="post" action="/admin/create?token={{ token }}">
    HWID:
    <input name="hwid" required>
    &nbsp; Days:
    <input name="days" value="30" size="3">
    <button type="submit">Create</button>
</form>

<hr>

<h3>Existing licenses</h3>
<table border="1" cellpadding="6">
    <tr>
        <th>ID</th>
        <th>License</th>
        <th>HWID</th>
        <th>Valid Until</th>
        <th>Revoked</th>
        <th>Actions</th>
    </tr>

    {% for r in licenses %}
    <tr>
        <td>{{ r.id }}</td>
        <td style="font-family: monospace">{{ r.license_key }}</td>
        <td>{{ r.hwid }}</td>
        <td>{{ r.valid_until }}</td>
        <td>{{ r.revoked }}</td>
        <td>
            {% if r.revoked == 0 %}
            <form style="display:inline" method="post" action="/admin/revoke?token={{ token }}">
                <input type="hidden" name="license_key" value="{{ r.license_key }}">
                <button type="submit">Revoke</button>
            </form>
            {% else %}
            Revoked
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>

<hr>

<h3>Recent activations</h3>
<table border="1" cellpadding="6">
    <tr>
        <th>ID</th>
        <th>License</th>
        <th>HWID</th>
        <th>IP</th>
        <th>Timestamp</th>
    </tr>

    {% for a in activations %}
    <tr>
        <td>{{ a.id }}</td>
        <td style="font-family: monospace">{{ a.license_key }}</td>
        <td>{{ a.hwid }}</td>
        <td>{{ a.ip }}</td>
        <td>{{ a.ts }}</td>
    </tr>
    {% endfor %}
</table>

</body>
</html>
